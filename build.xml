<?xml version="1.0" encoding="utf-8" ?>

<project name="OrderMeal" default="makewar" basedir=".">

	<property name="name" value="OrderMeal" />

	<!-- 代码相关路径 -->
	<property name="src.dir" value="${basedir}/src" />
	<property name="webroot.dir" value="${basedir}/WebRoot" />
	<property name="meta-inf.dir" value="${webroot.dir}/META-INF" />
	<property name="web-inf.dir" value="${webroot.dir}/WEB-INF" />
	<property name="lib.dir" value="${web-inf.dir}/lib" />
	

	<!-- 编译好的，放在release目录下面 -->
	<property name="release.dir" value="${basedir}/release" />
	<property name="release.meta-inf.dir" value="${release.dir}/META-INF" />
	<property name="release.web-inf.dir" value="${release.dir}/WEB-INF" />
	<property name="release.classes.dir" value="${release.web-inf.dir}/classes" />
	
	<!-- 编译时所需要的jar包路径 -->
	<path id="compile.classpath">
		<fileset dir="${lib.dir}" includes="**/*.jar" />
	</path>

	<!-- 删除发布目录 -->
	<target name="clean" description="Remove all generated files.">
		<delete dir="${release.dir}" />
	</target>

	<!-- 新建发布目录基本结构  -->
	<target name="initdir" description="mkdir">
		<mkdir dir="${release.dir}" />
		<copydir dest="${release.dir}" src="${webroot.dir}" />
		<deltree dir="release.classes.dir"/>
	</target>

	<target name="clean-build" depends="clean,initdir" />
	
	<target name="compile">
		<javac encoding="utf-8" srcdir="${src.dir}" destdir="${release.classes.dir}" classpathref="compile.classpath" />
	</target>

	<target name="build" depends="clean-build,compile" />

	<target name="makewar" depends="build">
		<war destfile="${release.dir}/OrderMeal.war" webxml="${web-inf.dir}/web.xml">
			<lib dir="${lib.dir}" />
			<classes dir="${release.classes.dir}" />
			<webinf dir="${web-inf.dir}" />
		</war>
	</target>




</project>